{"ast":null,"code":"import{useState,useEffect}from'react';import axios from'axios';import sadnessImg from'./images/sadness.png';import anxietyImg from'./images/anxiety.png';import fearImg from'./images/fear.png';import mypageUser from'./images/mypageuser.png';const useUserData=function(){let initialData=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};const[firstName,setFirstName]=useState(initialData.firstName||'');const[lastName,setLastName]=useState(initialData.lastName||'');const[usernickname,setUsernickname]=useState(initialData.usernickname||'');const[birth,setBirth]=useState(initialData.birth||'');const[gender,setGender]=useState(initialData.gender||'');const[userId,setUserId]=useState(initialData.userId||'');const[password,setPassword]=useState(initialData.password||'');const[state,setState]=useState(initialData.state||'');const[roomid,setroomid]=useState(initialData.roomid||'');const[profileImage,setProfileImage]=useState(mypageUser);// 프로필 이미지 초기값 : mypageUser로 설정해둠\nconst fetchUserData=async()=>{try{// 사용자가 로그인한 후 호출 (유저정보 가져오기)\nconst response=await axios.post('/mypage');const userData=response.data;setFirstName(userData.Lastname||'');setLastName(userData.Firstname||'');setUsernickname(userData.nickname||'');setBirth(userData.birth||'');setGender(userData.gender||'');setUserId(userData.id||'');// 아이디 값 변경 불가\nsetPassword(userData.password||'');setState(userData.state||'');setroomid(userData.roomid||'');setProfileImage(getProfileImage(userData.state));}catch(error){console.error('사용자 데이터를 가져오는 중 오류 발생:',error);}};const getProfileImage=state=>{switch(state){case'우울':return sadnessImg;case'불안':return anxietyImg;case'강박':return fearImg;default:return mypageUser;}};// 초기 유저정보 가져옴\nuseEffect(()=>{fetchUserData();},[]);const handleSave=async()=>{try{const updateData={lastName,firstName,gender,birth,nickname:usernickname,id:userId,password,roomid,state};// 정보 수정 시 데이터 전달 경로\nconsole.log('Sending update data:',updateData);const response=await axios.post('/mypage/process/update',updateData);if(response.status===200){alert('변경사항이 저장되었습니다.');}else{fetchUserData();// 변경사항 저장 후 유저정보를 다시 불러옴\nthrow new Error(response.data.message);}}catch(error){console.error('변경사항을 저장하는 데 오류가 발생했습니다:',error);alert('변경사항을 저장하는 데 오류가 발생했습니다.');}};return{firstName,lastName,usernickname,birth,gender,userId,password,roomid,state,profileImage,setFirstName,setLastName,setUsernickname,setBirth,setGender,setUserId,setPassword,setroomid,setState,setProfileImage,handleSave,fetchUserData};};export default useUserData;","map":{"version":3,"names":["useState","useEffect","axios","sadnessImg","anxietyImg","fearImg","mypageUser","useUserData","initialData","arguments","length","undefined","firstName","setFirstName","lastName","setLastName","usernickname","setUsernickname","birth","setBirth","gender","setGender","userId","setUserId","password","setPassword","state","setState","roomid","setroomid","profileImage","setProfileImage","fetchUserData","response","post","userData","data","Lastname","Firstname","nickname","id","getProfileImage","error","console","handleSave","updateData","log","status","alert","Error","message"],"sources":["C:/Users/atwod/OneDrive/바탕 화면/동국대 폴더/백엔드 공부/실전 2차/HackathonProject2_OutsideIn_UPGRADED/front-end/src/components/useUserData.js"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport sadnessImg from './images/sadness.png';\r\nimport anxietyImg from './images/anxiety.png';\r\nimport fearImg from './images/fear.png';\r\nimport mypageUser from './images/mypageuser.png';\r\n\r\nconst useUserData = (initialData = {}) => {\r\n  const [firstName, setFirstName] = useState(initialData.firstName || '');\r\n  const [lastName, setLastName] = useState(initialData.lastName || '');\r\n  const [usernickname, setUsernickname] = useState(initialData.usernickname || '');\r\n  const [birth, setBirth] = useState(initialData.birth || '');\r\n  const [gender, setGender] = useState(initialData.gender || '');\r\n  const [userId, setUserId] = useState(initialData.userId || '');\r\n  const [password, setPassword] = useState(initialData.password || '');\r\n  const [state, setState] = useState(initialData.state || '');\r\n  const [roomid, setroomid] = useState(initialData.roomid || '');\r\n  const [profileImage, setProfileImage] = useState(mypageUser); // 프로필 이미지 초기값 : mypageUser로 설정해둠\r\n\r\n  const fetchUserData = async () => {\r\n    try {\r\n      // 사용자가 로그인한 후 호출 (유저정보 가져오기)\r\n      const response = await axios.post('/mypage');\r\n      const userData = response.data;\r\n\r\n      setFirstName(userData.Lastname || '');\r\n      setLastName(userData.Firstname || '');\r\n      setUsernickname(userData.nickname || '');\r\n      setBirth(userData.birth || '');\r\n      setGender(userData.gender || '');\r\n      setUserId(userData.id || ''); // 아이디 값 변경 불가\r\n      setPassword(userData.password || '');\r\n      setState(userData.state || '');\r\n      setroomid(userData.roomid || '');\r\n      setProfileImage(getProfileImage(userData.state));\r\n    } catch (error) {\r\n      console.error('사용자 데이터를 가져오는 중 오류 발생:', error);\r\n    }\r\n  };\r\n\r\n  const getProfileImage = (state) => {\r\n    switch (state) {\r\n      case '우울':\r\n        return sadnessImg;\r\n      case '불안':\r\n        return anxietyImg;\r\n      case '강박':\r\n        return fearImg;\r\n      default:\r\n        return mypageUser;\r\n    }\r\n  };\r\n\r\n  // 초기 유저정보 가져옴\r\n  useEffect(() => {\r\n    fetchUserData();\r\n  }, []);\r\n\r\n  const handleSave = async () => {\r\n    try {\r\n      const updateData = {\r\n        lastName,\r\n        firstName,\r\n        gender,\r\n        birth,\r\n        nickname: usernickname,\r\n        id: userId,\r\n        password,\r\n        roomid,\r\n        state,\r\n      };\r\n\r\n      // 정보 수정 시 데이터 전달 경로\r\n      console.log('Sending update data:', updateData);\r\n      const response = await axios.post('/mypage/process/update', updateData);\r\n\r\n      if (response.status === 200) {\r\n        alert('변경사항이 저장되었습니다.');\r\n      } else {\r\n        fetchUserData(); // 변경사항 저장 후 유저정보를 다시 불러옴\r\n        throw new Error(response.data.message);\r\n      }\r\n    } catch (error) {\r\n      console.error('변경사항을 저장하는 데 오류가 발생했습니다:', error);\r\n      alert('변경사항을 저장하는 데 오류가 발생했습니다.');\r\n    }\r\n  };\r\n\r\n  return {\r\n    firstName,\r\n    lastName,\r\n    usernickname,\r\n    birth,\r\n    gender,\r\n    userId,\r\n    password,\r\n    roomid,\r\n    state,\r\n    profileImage,\r\n    setFirstName,\r\n    setLastName,\r\n    setUsernickname,\r\n    setBirth,\r\n    setGender,\r\n    setUserId,\r\n    setPassword,\r\n    setroomid,\r\n    setState,\r\n    setProfileImage,\r\n    handleSave,\r\n    fetchUserData,\r\n  };\r\n};\r\n\r\nexport default useUserData;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}