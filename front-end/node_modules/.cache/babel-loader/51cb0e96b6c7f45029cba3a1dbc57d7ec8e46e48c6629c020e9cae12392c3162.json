{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useParams,useNavigate}from'react-router-dom';import CRUDHeader from'./CRUDHeader';import'./CRUD.css';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function UpdateJoy(){const{no}=useParams();const navigate=useNavigate();const[post,setPost]=useState({title:'',body:''});const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[canEdit,setCanEdit]=useState(false);useEffect(()=>{axios.get(\"/joy/Postview/\".concat(no,\"/process/update\")).then(response=>{const{title,content}=response.data;setPost({title,body:content});setLoading(false);setCanEdit(true);}).catch(error=>{if(error.response&&error.response.status===403){alert('수정 권한이 없습니다.');navigate(\"/joy/PostView/\".concat(no));}else{console.error('게시글을 불러오는 중 오류가 발생했습니다!',error);setError('게시글을 불러오는 중 오류가 발생했습니다!');setLoading(false);}});},[no,navigate]);const onChange=event=>{const{value,name}=event.target;console.log(\"name: \".concat(name,\", value: \").concat(value));setPost({...post,[name]:value});};const updatePost=async event=>{event.preventDefault();try{await axios.post(\"/joy/Postview/\".concat(no,\"/process/update\"),{title:post.title,content:post.body});alert('수정되었습니다.');navigate(\"/joy/PostView/\".concat(no));}catch(error){if(error.response&&error.response.status===403){alert('수정 권한이 없습니다.');navigate(\"/joy/PostView/\".concat(no));}else{console.error('게시글을 수정하는 중 오류가 발생했습니다:',error);alert('게시글을 수정하는 중 오류가 발생했습니다:');}}};const backToList=()=>{navigate(\"/joy/PostView/\".concat(no));};if(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"\\uB85C\\uB529 \\uC911...\"});}if(error){return/*#__PURE__*/_jsx(\"div\",{children:error});}if(!canEdit){return/*#__PURE__*/_jsx(\"div\",{children:\"\\uC218\\uC815 \\uAD8C\\uD55C\\uC774 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"});// 수정 권한이 없을 때 보여줄 내용\n}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(CRUDHeader,{title:\"\\uAE30\\uC068\\uC774 \\uAE00\\uC218\\uC815\"})}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:updatePost,children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uC81C\\uBAA9\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"title\",placeholder:\"\\uC81C\\uBAA9\",value:post.title,onChange:onChange})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uB0B4\\uC6A9\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"body\",placeholder:\"\\uB0B4\\uC6A9\",value:post.body,onChange:onChange})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:backToList,children:\"\\uCDE8\\uC18C\"}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"\\uC218\\uC815\\uD558\\uAE30\"})]})]});}export default UpdateJoy;","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","CRUDHeader","axios","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","UpdateJoy","no","navigate","post","setPost","title","body","loading","setLoading","error","setError","canEdit","setCanEdit","get","concat","then","response","content","data","catch","status","alert","console","onChange","event","value","name","target","log","updatePost","preventDefault","backToList","children","onSubmit","type","placeholder","onClick"],"sources":["C:/Users/atwod/OneDrive/바탕 화면/동국대 폴더/백엔드 공부/실전 2차/HackathonProject2_OutsideIn_UPGRADED/front-end/src/components/community/CRUD/UpdateJoy.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport CRUDHeader from './CRUDHeader';\r\nimport './CRUD.css';\r\nimport axios from 'axios';\r\n\r\nfunction UpdateJoy() {\r\n  const { no } = useParams();\r\n  const navigate = useNavigate();\r\n  const [post, setPost] = useState({\r\n    title: '',\r\n    body: '',\r\n  });\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [canEdit, setCanEdit] = useState(false);\r\n\r\n  useEffect(() => {\r\n    axios\r\n      .get(`/joy/Postview/${no}/process/update`)\r\n      .then((response) => {\r\n        const { title, content } = response.data;\r\n        setPost({ title, body: content });\r\n        setLoading(false);\r\n        setCanEdit(true);\r\n      })\r\n      .catch((error) => {\r\n        if (error.response && error.response.status === 403) {\r\n          alert('수정 권한이 없습니다.');\r\n          navigate(`/joy/PostView/${no}`);\r\n        } else {\r\n          console.error('게시글을 불러오는 중 오류가 발생했습니다!', error);\r\n          setError('게시글을 불러오는 중 오류가 발생했습니다!');\r\n          setLoading(false);\r\n        }\r\n      });\r\n  }, [no, navigate]);\r\n\r\n  const onChange = (event) => {\r\n    const { value, name } = event.target;\r\n    console.log(`name: ${name}, value: ${value}`);\r\n    setPost({\r\n      ...post,\r\n      [name]: value,\r\n    });\r\n  };\r\n\r\n  const updatePost = async (event) => {\r\n    event.preventDefault();\r\n    try {\r\n      await axios.post(`/joy/Postview/${no}/process/update`, { title: post.title, content: post.body });\r\n      alert('수정되었습니다.');\r\n      navigate(`/joy/PostView/${no}`);\r\n    } catch (error) {\r\n      if (error.response && error.response.status === 403) {\r\n        alert('수정 권한이 없습니다.');\r\n        navigate(`/joy/PostView/${no}`);\r\n      } else {\r\n        console.error('게시글을 수정하는 중 오류가 발생했습니다:', error);\r\n        alert('게시글을 수정하는 중 오류가 발생했습니다:');\r\n      }\r\n    }\r\n  };\r\n\r\n  const backToList = () => {\r\n    navigate(`/joy/PostView/${no}`);\r\n  };\r\n\r\n  if (loading) {\r\n    return <div>로딩 중...</div>;\r\n  }\r\n\r\n  if (error) {\r\n    return <div>{error}</div>;\r\n  }\r\n  if (!canEdit) {\r\n    return <div>수정 권한이 없습니다.</div>; // 수정 권한이 없을 때 보여줄 내용\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div>\r\n        <CRUDHeader title=\"기쁨이 글수정\" />\r\n      </div>\r\n      <form onSubmit={updatePost}>\r\n        <div>\r\n          <span>제목</span>\r\n          <input type=\"text\" name=\"title\" placeholder=\"제목\" value={post.title} onChange={onChange} />\r\n        </div>\r\n        <br />\r\n        <div>\r\n          <span>내용</span>\r\n          <textarea name=\"body\" placeholder=\"내용\" value={post.body} onChange={onChange}></textarea>\r\n        </div>\r\n        <br />\r\n        <button type=\"button\" onClick={backToList}>\r\n          취소\r\n        </button>\r\n        <input type=\"submit\" value=\"수정하기\"></input>\r\n      </form>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default UpdateJoy;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}